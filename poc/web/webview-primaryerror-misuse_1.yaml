id: webview-primaryerror-misuse

info:
  name: Android WebView Weak SSL Error Handling (getPrimaryError misuse)
  author: S1rN3tZ
  severity: info
  description: |
    Detects suspicious SSL/TLS error handling in Android WebViews where
    getPrimaryError() is used for decision-making. Relying only on the
    primary error code may overlook additional errors in the certificate
    chain and can still weaken SSL security.

file:
  - extensions:
      - java
      - kt
      - smali
    matchers:
      - type: word
        part: content
        words:
          - "getPrimaryError("
          - "error.getPrimaryError("
        name: primary-error-used
