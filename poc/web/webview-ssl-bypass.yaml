id: webview-ssl-bypass

info:
  name: Android WebView SSL Bypass (MASTG-TEST-0284)
  author: S1rN3tZ
  severity: high
  description: |
    Detects insecure SSL/TLS error handling in Android WebViews where
    onReceivedSslError(...) overrides call SslErrorHandler.proceed(),
    bypassing certificate validation and allowing MITM attacks.

file:
  - extensions:
      - java
      - kt
      - smali
    matchers-condition: and
    matchers:
      - type: regex
        part: content
        regex:
          - '(void\s+onReceivedSslError\s*\(.*SslErrorHandler.*\))'
          - '(\.method[\s\S]*onReceivedSslError\(Landroid/webkit/WebView;Landroid/webkit/SslErrorHandler;Landroid/net/http/SslError;\)V)'
        name: onreceivedssl-method

      - type: word
        part: content
        words:
          - "handler.proceed("
          - "SslErrorHandler.proceed("
          - "Landroid/webkit/SslErrorHandler;->proceed()V"
        name: proceed-called
