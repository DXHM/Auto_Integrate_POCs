id: CVE-2025-10749-windows_azure_storage-e1b80852-a221-4c2c-b76d-8bdcd1e0f1ad

info:
  name: >
    Microsoft Azure Storage for WordPress <= 4.5.1 - Missing Authorization to Authenticated (Subscriber+) Arbitrary Media Deletion
  author: topscoder
  severity: low
  description: >
    The Microsoft Azure Storage for WordPress plugin for WordPress is vulnerable to Unauthorized Arbitrary Media Deletion in all versions up to, and including, 4.5.1. This is due to missing capability checks on the 'azure-storage-media-replace' AJAX action. This makes it possible for authenticated attackers with subscriber-level access and above to delete arbitrary media files from the WordPress Media Library via the replace_attachment parameter granted they can access the nonce which is exposed to all authenticated users.
  reference:
    - https://github.com/topscoder/nuclei-wordfence-cve
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/e1b80852-a221-4c2c-b76d-8bdcd1e0f1ad?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:L
    cvss-score: 5.4
    cve-id: CVE-2025-10749
  metadata:
    fofa-query: "wp-content/plugins/windows-azure-storage/"
    google-query: inurl:"/wp-content/plugins/windows-azure-storage/"
    shodan-query: 'http.html:"wp-content/plugins/windows-azure-storage/"'
  tags: cve,wordpress,wp-plugin,windows-azure-storage,low,production

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/windows-azure-storage/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag:\\s*([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "windows-azure-storage"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 4.5.1')