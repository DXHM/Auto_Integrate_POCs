id: CVE-2005-2428

info:
  name: Lotus Domino R5 and R6 WebMail - Information Disclosure
  author: CasperGN
  severity: medium
  description: Lotus Domino R5 and R6 WebMail with 'Generate HTML for all fields' enabled (which is by default) allows remote attackers to read the HTML source to obtain sensitive information including the password hash in the HTTPPassword field, the password change date in the HTTPPasswordChangeDate field, and the client Lotus Domino release in the ClntBld field (a different vulnerability than CVE-2005-2696).
  remediation: Ensure proper firewalls are in place within your environment to prevent public exposure of the names.nsf database and other sensitive files.
  reference:
    - http://www.cybsec.com/vuln/default_configuration_information_disclosure_lotus_domino.pdf
    - https://www.exploit-db.com/exploits/39495
    - https://nvd.nist.gov/vuln/detail/CVE-2005-2428
    - http://marc.info/?l=bugtraq&m=112240869130356&w=2
    - http://securitytracker.com/id?1014584
  classification:
    cvss-metrics: CVSS:2.0/AV:N/AC:L/Au:N/C:P/I:N/A:N
    cvss-score: 5
    cve-id: CVE-2005-2428
    cwe-id: CWE-200
    epss-score: 0.01188
    epss-percentile: 0.83505
    cpe: cpe:2.3:a:ibm:lotus_domino:5.0:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: ibm
    product: lotus_domino
  tags: domino,edb,cve,cve2005

http:
  - method: GET
    path:
      - "{{BaseURL}}/names.nsf/People?OpenView"

    matchers-condition: and
    matchers:
      - type: regex
        name: domino-username
        part: body
        regex:
          - '(<a href="/names\.nsf/[0-9a-z\/]+\?OpenDocument)'

      - type: status
        status:
          - 200

# digest: 4a0a004730450221008029f9d7db08e0dcede7bfe7961c33c3da40c909a1e1a157e717c18fc679c02c02203735d28c2a7e0981818c5ddb2db9ea08f13e2d2f36043356ee11c533ee49d2c7:922c64590222798bb761d5b6d8e72950
